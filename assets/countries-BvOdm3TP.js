async function g(o,r,n,i){try{const t=await o();if(!t.ok){const c=await t.json().catch(()=>null),u=`${t.status} ${t.statusText}${c?.error?.message?` - ${c.error.message}`:""}`;return console.error(`[ERROR] ${n??"Fetching"}:`,u),"API error: "+u}const a=await t.json().catch(()=>null);let s=a;r&&s[r]&&(s=s[r]);const e=i?i(s):s;return{success:!0,message:a?.message??"Request successful",data:e}}catch(t){if(t instanceof Error){const a=t.name==="SyntaxError"?"FETCH error: Syntax error":`API error: ${t.message}`;return console.error(`[ERROR] Fetching ${n??""}:`,a),a}return console.error(`[ERROR] ${n??"Fetching"}:`,t),String(t)}}function p(o,r,n="GET"){return console.log(`[FETCH] ${n}:`,o),r!==void 0&&console.log(`[FETCH] ${n} payload:`,r),{url:o,payload:r,method:n}}function l(){let o,r,n,i,t="GET",a,s;return{useProperty(e){return o=e,this},useLog(e){return n=e,this},usePayload(e){return i=e,this},useTransform(e){return a=e,this},getFrom(e){return r=e,t="GET",this},postTo(e){return r=e,t="POST",this},putTo(e){return r=e,t="PUT",this},patchTo(e){return r=e,t="PATCH",this},deleteFrom(e){return r=e,t="DELETE",this},useToken(e){return s=e,this},async invoke(){if(!r)throw new Error("Target endpoint not defined. Use .getFrom(), .postTo(), etc.");const{url:e,payload:c,method:u}=p(r,i,t);return g(()=>fetch(e,{method:u,headers:{"Content-Type":"application/json",...s?{Authorization:`Bearer ${s}`}:{}},...c?{body:JSON.stringify(c)}:{}}),o,n,a)}}}async function h(){return l().getFrom("https://restcountries.com/v3.1/all?fields=name,capital,region,population,flags,cca2").useLog("Fetching countries").useTransform(o=>o.map((r,n)=>({id:n+1,cca2:r.cca2||"",name:r.name.common||"",capital:r.capital[0]||"",region:r.region,flag:r.flags.png||"",population:r.population}))).invoke()}async function m(o){return l().getFrom(`https://restcountries.com/v3.1/name/${o}`).invoke()}export{h as g,m as s};
