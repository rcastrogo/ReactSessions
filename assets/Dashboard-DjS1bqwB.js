import{r,j as e,U as F,a as y,S as c,V as w,I,B as H,K as U,u as V}from"./index-gZinIeTx.js";import{P as q}from"./PegeHeader-JVLCSEXN.js";import{I as z}from"./input-DbvIWgGl.js";import{s as G}from"./countries-BvOdm3TP.js";var K="Label",L=r.forwardRef((s,a)=>e.jsx(F.label,{...s,ref:a,onMouseDown:l=>{l.target.closest("button, input, select, textarea")||(s.onMouseDown?.(l),!l.defaultPrevented&&l.detail>1&&l.preventDefault())}}));L.displayName=K;var O=L;function C({className:s,...a}){return e.jsx(O,{"data-slot":"label",className:y("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...a})}const $=({searchProvider:s,onResults:a,onLoading:l,onItemSelected:d,onClear:u,renderItem:b=o=>e.jsx("span",{children:o.value}),listHeight:n="200px",debounceTime:i=300,minLength:f=3,onChange:M,onBlur:R,...E})=>{const[o,m]=r.useState([]),[p,T]=r.useState(-1),[B,g]=r.useState(!0),[x,S]=r.useState(!1),v=r.useRef(null),N=r.useRef(null),h=r.useRef(null),D=r.useCallback(t=>{h.current&&clearTimeout(h.current),h.current=window.setTimeout(async()=>{try{S(!0);const j=await s(t);m(j)}catch{m([])}finally{S(!1)}},i)},[i,s]),P=t=>{if(u&&u(),!t||t.length<f){m([]),T(-1),g(!0);return}g(!1),D(t)},A=t=>{v.current&&(v.current.value=t.value),d&&d(t),m([]),g(!0)};return r.useEffect(()=>{a&&a(o)},[a,o]),r.useEffect(()=>{l?.(x)},[x,l]),r.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]),r.useEffect(()=>{p>-1&&N.current&&N.current.children[p]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[p]),e.jsxs("div",{className:"relative",children:[e.jsx(z,{...E,autoComplete:"off",ref:v,onChange:t=>{P(t.target.value),M?.(t)},onBlur:t=>{setTimeout(()=>{a||m([]),g(!0)},150),R?.(t)}}),e.jsx(c,{when:a===void 0,children:e.jsxs("div",{className:y("absolute bg-background z-10 mt-2 w-full rounded-xl border p-3 shadow",{hidden:B}),children:[x&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(C,{children:w("general.action.loading")}),e.jsx(I,{})]}),!x&&o.length===0&&e.jsx(C,{children:w("general.noResultsInTable")}),!x&&o.length>0&&e.jsxs("div",{children:[e.jsx(C,{children:w("general.suggest_results",{count:o.length})}),e.jsx("div",{ref:N,className:"mt-2 flex flex-col gap-1 max-h-[200px] overflow-y-auto",style:{maxHeight:n},children:o.map((t,j)=>e.jsx(H,{type:"button",variant:"outline",className:y("justify-start",j===p&&"bg-muted text-muted-foreground"),onMouseDown:_=>_.preventDefault(),onClick:()=>A(t),children:b(t)},j))})]})]})})]})};function k({country:s}){return e.jsxs("div",{className:"bg-card border rounded-2xl shadow-md p-5 hover:shadow-xl transition max-w-md w-full",children:[e.jsx("img",{src:s.flags?.png,alt:s.flags?.alt||s.name.common,className:"w-full max-h-20 object-cover rounded-xl mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-1",children:s.name.common}),e.jsx("p",{className:"text-muted-foreground mb-4",children:s.name.official}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Capital"}),e.jsx("p",{children:s.capital?.[0]||"ï¿½"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Region"}),e.jsx("p",{children:s.region})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Subregion"}),e.jsx("p",{children:s.subregion})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Population"}),e.jsx("p",{children:U(s.population)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"CCA2"}),e.jsx("p",{children:s.cca2})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"CCA3"}),e.jsx("p",{children:s.cca3})]})]}),e.jsxs("div",{className:"mt-4 flex gap-3",children:[e.jsx("a",{href:s.maps?.googleMaps,target:"_blank",className:"text-primary underline text-sm hover:text-primary/70",children:"Google Maps"}),e.jsx("a",{href:s.maps?.openStreetMaps,target:"_blank",className:"text-primary underline text-sm hover:text-primary/70",children:"OpenStreetMap"})]})]})}function Y(){const{t:s}=V(),[a,l]=r.useState([]),[d,u]=r.useState(!1),b=async n=>{const i=await G(n);return typeof i=="string"?[]:i.data.map(f=>({...f,value:f.name.common||""}))};return e.jsxs("div",{className:"w-full flex-cols items-center",children:[e.jsx(q,{title:s("home.cards.dashboard.title"),imageUrl:"https://images.unsplash.com/photo-1534201041980-ab6cb6c36cc3?q=80&w=687&auto=format&fit=crop"}),e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 py-6 flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:s("dashboard.search-title")}),e.jsx("p",{className:"text-gray-500 text-sm",children:s("dashboard.search-description")}),e.jsx($,{placeholder:s("dashboard.search-placeholder"),minLength:2,debounceTime:400,searchProvider:b,onResults:n=>l(n),onLoading:n=>{if(!n){setTimeout(()=>u(!1),400);return}u(n)},className:"mt-2"}),e.jsx(c,{when:d,children:e.jsx(I,{containerClasses:"h-[2px]",progressClasses:"bg-gray-800 dark:bg-blue-800"})})]}),e.jsx(c,{when:a.length>0,children:e.jsxs("div",{className:"",children:[e.jsx("p",{className:"text-gray-700 font-medium mb-2 py-2 border-b",children:s("dashboard.results-found",{count:a.length})}),e.jsx(c,{when:a.length===1,children:e.jsx(k,{country:a[0]})}),e.jsx(c,{when:a.length>1,children:e.jsx("div",{className:`\r
            grid \r
            grid-cols-1 \r
            sm:grid-cols-2 \r
            lg:grid-cols-3 \r
            xl:grid-cols-4 \r
            gap-6\r
          `,children:a.map((n,i)=>e.jsx(k,{country:n},i))})})]})}),e.jsx(c,{when:a.length===0,children:e.jsx("p",{className:"text-gray-700 font-medium mt-2",children:s("dashboard.no-results")})})]})]})}export{Y as default};
